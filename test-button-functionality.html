<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Botón Actualizar</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 8px; }
        .btn { background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        .btn:hover { background: #5a6fd8; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        .log { background: #f8f9fa; padding: 10px; border-radius: 5px; margin: 10px 0; font-family: monospace; }
    </style>
</head>
<body>
    <h1>🧪 Test de Funcionalidad del Botón</h1>
    
    <div class="test-section">
        <h2>Test 1: Botón Manual</h2>
        <button class="btn" onclick="testManualButton()">🔄 Test Manual</button>
        <div id="manualResult" class="log"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 2: Simulación de Cambio de Tiendas</h2>
        <button class="btn" onclick="testStoreChange()">🏪 Test Cambio Tiendas</button>
        <div id="storeResult" class="log"></div>
    </div>
    
    <div class="test-section">
        <h2>Test 3: Simulación de loadData()</h2>
        <button class="btn" onclick="testLoadData()">📊 Test loadData</button>
        <div id="loadDataResult" class="log"></div>
    </div>

    <script>
        // Simular la función loadData
        async function loadData() {
            console.log('🔄 loadData() ejecutándose...');
            showLoadingIndicator();
            
            // Simular carga
            await new Promise(resolve => setTimeout(resolve, 1000));
            
            hideLoadingIndicator();
            console.log('✅ loadData() completado');
        }

        // Simular indicadores de carga
        function showLoadingIndicator() {
            const buttons = document.querySelectorAll('.btn');
            buttons.forEach(button => {
                if (button.innerHTML.includes('Test')) {
                    button.innerHTML = '⏳ Cargando...';
                    button.disabled = true;
                }
            });
        }

        function hideLoadingIndicator() {
            const buttons = document.querySelectorAll('.btn');
            buttons.forEach(button => {
                if (button.innerHTML.includes('Cargando')) {
                    button.innerHTML = button.innerHTML.replace('⏳ Cargando...', '🔄 Test Manual');
                }
            });
        }

        // Test 1: Botón manual
        async function testManualButton() {
            const result = document.getElementById('manualResult');
            result.innerHTML = '🔄 Ejecutando test manual...';
            
            try {
                await loadData();
                result.innerHTML = '✅ Test manual completado exitosamente';
            } catch (error) {
                result.innerHTML = `❌ Error en test manual: ${error.message}`;
            }
        }

        // Test 2: Simulación de cambio de tiendas
        function testStoreChange() {
            const result = document.getElementById('storeResult');
            result.innerHTML = '🏪 Simulando cambio de tiendas...';
            
            // Simular eventos de cambio
            setTimeout(() => {
                console.log('📋 Cambio simulado en selector de tiendas');
                loadData();
                result.innerHTML = '✅ Simulación de cambio de tiendas completada';
            }, 500);
        }

        // Test 3: Test directo de loadData
        async function testLoadData() {
            const result = document.getElementById('loadDataResult');
            result.innerHTML = '📊 Ejecutando loadData() directamente...';
            
            try {
                await loadData();
                result.innerHTML = '✅ loadData() ejecutado exitosamente';
            } catch (error) {
                result.innerHTML = `❌ Error en loadData(): ${error.message}`;
            }
        }

        // Log de consola
        console.log('🧪 Página de test cargada');
        console.log('📋 Funciones disponibles:');
        console.log('  • testManualButton()');
        console.log('  • testStoreChange()');
        console.log('  • testLoadData()');
        console.log('  • loadData()');
    </script>
</body>
</html>

